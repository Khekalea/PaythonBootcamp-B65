"use strict";(this.webpackChunk_msteams_light_meetings=this.webpackChunk_msteams_light_meetings||[]).push([["25151"],{355711:function(e,t,n){var r,s;n.d(t,{PL:()=>i,hy:()=>r}),(s=r||(r={})).default="default",s.skypeConCore="conCore",s.mediaAgent="mediaAgent",s.CDL="CDL",s.copilot="copilot",Object.entries(r).map(([e,t])=>({label:e,value:t}));let i=new Set(["AppInfo.ClientType","Window.Type","Panel.Context","Session.TelemetryWorkerType","AppInfo.ExpIds","UserInfo.ETag","UserInfo.HostETag","UserInfo.CountryCode","Window.Type","AppInfo.Version","AppInfo.ExperienceName"])},20104:function(e,t,n){n.d(t,{N:()=>q});var r,s,i,o,a,h,g,u,d,l,c=n(214342),I=n(122801),E=n(30178),T=n(992744),_=n(296791),m=n(313716),y=n(100171);let p=/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/i,C=new Set(["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","A","B","C","D","E","F"]);function L(e){return p.test(e)}function S(e){let t;try{t=e.includes("%")?decodeURIComponent(e):e}catch(n){t=e}return t}function N(e,t,n){if(!n)return{};let r=Object.entries(n.scannerOptions||{}).find(([t])=>t===e)?.[1],s={};for(let e of t){let t=Object.entries(r||{}).find(([t])=>t===e)?.[1];void 0!==t&&(s[e]=t)}return s}function R(e){if(e&&0!==e.length)return RegExp(`(${e.map(e=>`(?:${e})`).join("|")})`,"i")}var f=n(61174),b=n.n(f),D=n(773909);class v extends D.h{shouldScan(e){return super.shouldScan(e),!(e.length>v.MAX_FIELD_LENGTH)&&this.teamsShouldScan(e)}scan(e){return this.teamsScan(e)}}v.MAX_FIELD_LENGTH=2e5;class G extends v{constructor(e){super(),this.identifier="Teams_Email",this.trustedDomains=new Set(this.extractEmailTrustedDomains(e))}teamsShouldScan(e){return G.AT_SYMBOLS_SHOULD_SCAN_REGEX.test(e)}teamsScan(e){let t;G.EMAIL_MATCHER_REGEX.lastIndex=0;let n=S(e).replace(G.AT_SYMBOL_SCAN_REGEX,"@");for(;null!==(t=G.EMAIL_MATCHER_REGEX.exec(n));){let e=t[0],n=e.indexOf("@"),r=e.substring(n+1).toLowerCase();if(L(e))continue;let s=!1;for(let e of this.trustedDomains)if(r.includes(e)){s=!0;break}if(!s&&b()(e,{allow_underscores:!0}))return!0}return!1}extractEmailTrustedDomains(e){let t=N("Email",["trustedDomains"],e);return Array.isArray(t.trustedDomains)?t.trustedDomains:[]}}G.AT_SYMBOLS_SHOULD_SCAN_REGEX=RegExp("@|_at_|%40","i"),G.AT_SYMBOL_SCAN_REGEX=/_at_/gi,G.EMAIL_MATCHER_REGEX=/\b[a-zA-Z0-9._%+-]+@[a-zA-Z0-9\u00A0-\uFFFF-]+(?:\.[a-zA-Z0-9\u00A0-\uFFFF-]+)*\.[a-zA-Z\u00A0-\uFFFF]{2,}\b/gi;class M extends v{constructor(e){super(),this.identifier="Teams_FileName",this.fileNameScannerOptions=this.extractFileNameScannerOptions(e)}teamsShouldScan(e){return!(e.length<M.MIN_FILENAME_LENGTH||this.fileNameScannerOptions.messagePatternsToIgnoreRegex?.test(e))&&M.FILE_EXTENSION_REGEX.test(e)}teamsScan(e){for(let t of S(e).split(M.COMMON_DELIMITERS_REGEX))if(this.isValidFileName(t))return!0;return!1}isValidFileName(e){let t=e.trim().toLowerCase(),n=t.length;if(n<=M.MIN_FILENAME_LENGTH||n>=M.MAX_FILENAME_LENGTH)return!1;let r=t.lastIndexOf(".");if(r<=0)return!1;let s=t.substring(r+1);if(!M.FileExtensions.has(s))return!1;let i=t.substring(0,r);return!("7z"===s&&!Number.isNaN(Number(i))||i.length>=M.MIN_UUID_LENGTH&&i.includes("-")&&L(i)||this.fileNameScannerOptions.fileNamePatternsToIgnoreRegex?.test(t))}extractFileNameScannerOptions(e){let t=N(this.identifier,["fileNamePatternsToIgnore","messagePatternsToIgnore"],e);return{fileNamePatternsToIgnoreRegex:Array.isArray(t.fileNamePatternsToIgnore)?R(t.fileNamePatternsToIgnore):void 0,messagePatternsToIgnoreRegex:Array.isArray(t.messagePatternsToIgnore)?R(t.messagePatternsToIgnore):void 0}}}M.MIN_FILENAME_LENGTH=4,M.MAX_FILENAME_LENGTH=255,M.MIN_UUID_LENGTH=36,M.FileExtensions=new Set(["pdf","docx","doc","xlsx","xls","pptx","ppt","txt","rtf","odt","csv","jpeg","jpg","png","gif","svg","mp4","avi","mov","wmv","mkv","zip","rar","7z","tar","gz"]),M.EXTENSION_PATTERN=`\\.(${Array.from(M.FileExtensions).join("|")})\\b`,M.FILE_EXTENSION_REGEX=RegExp(M.EXTENSION_PATTERN,"i"),M.COMMON_DELIMITERS_REGEX=/[\s,;:"'<>()[\]{}|?=&/\\]/,(r=h||(h={}))[r.THREE=3]="THREE",r[r.FOUR=4]="FOUR",r[r.FIVE=5]="FIVE",r[r.SIX=6]="SIX",r[r.SEVEN=7]="SEVEN",r[r.EIGHT=8]="EIGHT",r[r.NINE=9]="NINE",r[r.TEN=10]="TEN",r[r.ELEVEN=11]="ELEVEN",r[r.TWELVE=12]="TWELVE",r[r.THIRTEEN=13]="THIRTEEN",r[r.FIFTEEN=15]="FIFTEEN",r[r.SEVENTEEN=17]="SEVENTEEN",(s=g||(g={}))[s.ONE_DIGIT=1]="ONE_DIGIT",s[s.TWO_DIGITS=2]="TWO_DIGITS",s[s.THREE_DIGITS=3]="THREE_DIGITS";let O={1:{countryCode:"1",countryCodeLength:g.ONE_DIGIT,phoneNumberLengths:[h.TEN],isRange:!1},30:{countryCode:"30",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.TEN],isRange:!1},31:{countryCode:"31",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},32:{countryCode:"32",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.EIGHT,h.NINE],isRange:!0},33:{countryCode:"33",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},34:{countryCode:"34",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},36:{countryCode:"36",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.EIGHT,h.NINE],isRange:!0},39:{countryCode:"39",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.SIX,h.ELEVEN],isRange:!0},40:{countryCode:"40",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},41:{countryCode:"41",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.FOUR,h.TWELVE],isRange:!0},43:{countryCode:"43",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.FOUR,h.THIRTEEN],isRange:!0},44:{countryCode:"44",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.SEVEN,h.TEN],isRange:!0},45:{countryCode:"45",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},46:{countryCode:"46",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.SEVEN,h.THIRTEEN],isRange:!0},47:{countryCode:"47",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.FIVE,h.EIGHT],isRange:!1},48:{countryCode:"48",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.SIX,h.NINE],isRange:!0},49:{countryCode:"49",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.SIX,h.THIRTEEN],isRange:!0},60:{countryCode:"60",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.SEVEN,h.NINE],isRange:!0},61:{countryCode:"61",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.FIVE,h.FIFTEEN],isRange:!0},62:{countryCode:"62",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.FIVE,h.TEN],isRange:!0},63:{countryCode:"63",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.EIGHT,h.TEN],isRange:!0},64:{countryCode:"64",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.THREE,h.TEN],isRange:!0},65:{countryCode:"65",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.EIGHT,h.TWELVE],isRange:!0},66:{countryCode:"66",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.EIGHT,h.NINE],isRange:!1},81:{countryCode:"81",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.FIVE,h.THIRTEEN],isRange:!0},82:{countryCode:"82",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.EIGHT,h.ELEVEN],isRange:!0},84:{countryCode:"84",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.SEVEN,h.TEN],isRange:!0},86:{countryCode:"86",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.FIVE,h.TWELVE],isRange:!0},91:{countryCode:"91",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.SEVEN,h.TEN],isRange:!0},92:{countryCode:"92",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.EIGHT,h.ELEVEN],isRange:!0},7:{countryCode:"7",countryCodeLength:g.ONE_DIGIT,phoneNumberLengths:[h.TEN],isRange:!1},51:{countryCode:"51",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.EIGHT,h.ELEVEN],isRange:!0},52:{countryCode:"52",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.TEN],isRange:!1},53:{countryCode:"53",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.SIX,h.EIGHT],isRange:!0},54:{countryCode:"54",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.TEN],isRange:!1},55:{countryCode:"55",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.TEN],isRange:!1},56:{countryCode:"56",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.EIGHT,h.NINE],isRange:!0},57:{countryCode:"57",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.EIGHT,h.TEN],isRange:!1},58:{countryCode:"58",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.TEN],isRange:!1},20:{countryCode:"20",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.SEVEN,h.NINE],isRange:!0},27:{countryCode:"27",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},212:{countryCode:"212",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},213:{countryCode:"213",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT,h.NINE],isRange:!1},216:{countryCode:"216",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},218:{countryCode:"218",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT,h.NINE],isRange:!0},220:{countryCode:"220",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN],isRange:!1},221:{countryCode:"221",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},222:{countryCode:"222",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN],isRange:!1},223:{countryCode:"223",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},224:{countryCode:"224",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},225:{countryCode:"225",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},226:{countryCode:"226",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},227:{countryCode:"227",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},228:{countryCode:"228",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},229:{countryCode:"229",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},230:{countryCode:"230",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN],isRange:!1},231:{countryCode:"231",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN,h.EIGHT],isRange:!0},232:{countryCode:"232",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},233:{countryCode:"233",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FIVE,h.NINE],isRange:!0},234:{countryCode:"234",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN,h.TEN],isRange:!0},235:{countryCode:"235",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},236:{countryCode:"236",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},237:{countryCode:"237",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},238:{countryCode:"238",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN],isRange:!1},239:{countryCode:"239",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN],isRange:!1},240:{countryCode:"240",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},241:{countryCode:"241",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SIX,h.SEVEN],isRange:!1},242:{countryCode:"242",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},243:{countryCode:"243",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FIVE,h.NINE],isRange:!0},244:{countryCode:"244",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},245:{countryCode:"245",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN],isRange:!1},246:{countryCode:"246",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN],isRange:!1},247:{countryCode:"247",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FOUR],isRange:!1},248:{countryCode:"248",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN],isRange:!1},249:{countryCode:"249",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},250:{countryCode:"250",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},251:{countryCode:"251",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},252:{countryCode:"252",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FIVE,h.EIGHT],isRange:!0},253:{countryCode:"253",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SIX],isRange:!1},254:{countryCode:"254",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SIX,h.TEN],isRange:!0},255:{countryCode:"255",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},256:{countryCode:"256",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},257:{countryCode:"257",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},258:{countryCode:"258",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT,h.NINE],isRange:!0},260:{countryCode:"260",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},261:{countryCode:"261",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.NINE,h.TEN],isRange:!0},262:{countryCode:"262",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},263:{countryCode:"263",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FIVE,h.TEN],isRange:!0},264:{countryCode:"264",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SIX,h.TEN],isRange:!0},265:{countryCode:"265",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN,h.EIGHT],isRange:!1},266:{countryCode:"266",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},267:{countryCode:"267",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN,h.EIGHT],isRange:!0},268:{countryCode:"268",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN,h.EIGHT],isRange:!0},269:{countryCode:"269",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN],isRange:!1},290:{countryCode:"290",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FOUR],isRange:!1},291:{countryCode:"291",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN],isRange:!1},297:{countryCode:"297",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN],isRange:!1},298:{countryCode:"298",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SIX],isRange:!1},299:{countryCode:"299",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SIX],isRange:!1},350:{countryCode:"350",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},351:{countryCode:"351",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.NINE,h.ELEVEN],isRange:!1},352:{countryCode:"352",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FOUR,h.ELEVEN],isRange:!0},353:{countryCode:"353",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN,h.ELEVEN],isRange:!0},354:{countryCode:"354",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN,h.NINE],isRange:!1},355:{countryCode:"355",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.THREE,h.NINE],isRange:!0},356:{countryCode:"356",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},357:{countryCode:"357",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT,h.ELEVEN],isRange:!1},358:{countryCode:"358",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FIVE,h.TWELVE],isRange:!0},359:{countryCode:"359",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN,h.NINE],isRange:!0},370:{countryCode:"370",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},371:{countryCode:"371",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN,h.EIGHT],isRange:!1},372:{countryCode:"372",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN,h.TEN],isRange:!0},373:{countryCode:"373",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},374:{countryCode:"374",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},375:{countryCode:"375",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.NINE,h.TEN],isRange:!0},376:{countryCode:"376",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SIX,h.EIGHT,h.NINE],isRange:!1},377:{countryCode:"377",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FIVE,h.NINE],isRange:!0},378:{countryCode:"378",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SIX,h.TEN],isRange:!0},380:{countryCode:"380",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},381:{countryCode:"381",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FOUR,h.TWELVE],isRange:!0},382:{countryCode:"382",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FOUR,h.TWELVE],isRange:!0},385:{countryCode:"385",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT,h.TWELVE],isRange:!0},386:{countryCode:"386",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},387:{countryCode:"387",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},389:{countryCode:"389",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},420:{countryCode:"420",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FOUR,h.TWELVE],isRange:!0},421:{countryCode:"421",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FOUR,h.NINE],isRange:!0},423:{countryCode:"423",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN,h.NINE],isRange:!0},500:{countryCode:"500",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FIVE],isRange:!1},501:{countryCode:"501",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN],isRange:!1},502:{countryCode:"502",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},503:{countryCode:"503",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN,h.EIGHT,h.ELEVEN],isRange:!1},504:{countryCode:"504",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},505:{countryCode:"505",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},506:{countryCode:"506",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},507:{countryCode:"507",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN,h.EIGHT],isRange:!1},508:{countryCode:"508",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SIX],isRange:!1},509:{countryCode:"509",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},590:{countryCode:"590",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},591:{countryCode:"591",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},592:{countryCode:"592",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN],isRange:!1},593:{countryCode:"593",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},594:{countryCode:"594",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},595:{countryCode:"595",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FIVE,h.NINE],isRange:!0},596:{countryCode:"596",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},597:{countryCode:"597",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SIX,h.SEVEN],isRange:!0},598:{countryCode:"598",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FOUR,h.ELEVEN],isRange:!0},599:{countryCode:"599",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN,h.EIGHT],isRange:!0},670:{countryCode:"670",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN],isRange:!1},672:{countryCode:"672",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SIX],isRange:!1},673:{countryCode:"673",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN],isRange:!1},674:{countryCode:"674",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FOUR,h.SEVEN],isRange:!1},675:{countryCode:"675",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FOUR,h.ELEVEN],isRange:!0},676:{countryCode:"676",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FIVE,h.SEVEN],isRange:!1},677:{countryCode:"677",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FIVE],isRange:!1},678:{countryCode:"678",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FIVE,h.SEVEN],isRange:!1},679:{countryCode:"679",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN],isRange:!1},680:{countryCode:"680",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN],isRange:!1},681:{countryCode:"681",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SIX],isRange:!1},682:{countryCode:"682",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FIVE],isRange:!1},683:{countryCode:"683",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FOUR],isRange:!1},685:{countryCode:"685",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.THREE,h.SEVEN],isRange:!0},686:{countryCode:"686",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FIVE],isRange:!1},687:{countryCode:"687",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SIX],isRange:!1},688:{countryCode:"688",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FIVE,h.SIX],isRange:!1},689:{countryCode:"689",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SIX],isRange:!1},690:{countryCode:"690",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FOUR],isRange:!1},691:{countryCode:"691",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN],isRange:!1},692:{countryCode:"692",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN],isRange:!1},800:{countryCode:"800",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},808:{countryCode:"808",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},850:{countryCode:"850",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SIX,h.SEVENTEEN],isRange:!0},852:{countryCode:"852",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT,h.NINE],isRange:!0},853:{countryCode:"853",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN,h.EIGHT],isRange:!0},855:{countryCode:"855",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},856:{countryCode:"856",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT,h.TEN],isRange:!0},870:{countryCode:"870",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},880:{countryCode:"880",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SIX,h.TEN],isRange:!0},886:{countryCode:"886",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT,h.NINE],isRange:!0},90:{countryCode:"90",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.TEN],isRange:!1},94:{countryCode:"94",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},95:{countryCode:"95",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.SEVEN,h.NINE],isRange:!0},98:{countryCode:"98",countryCodeLength:g.TWO_DIGITS,phoneNumberLengths:[h.SIX,h.TEN],isRange:!0},960:{countryCode:"960",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN],isRange:!1},961:{countryCode:"961",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN,h.EIGHT],isRange:!0},962:{countryCode:"962",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.FIVE,h.NINE],isRange:!0},963:{countryCode:"963",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT,h.TEN],isRange:!0},964:{countryCode:"964",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT,h.TEN],isRange:!0},965:{countryCode:"965",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN,h.EIGHT],isRange:!1},966:{countryCode:"966",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT,h.NINE],isRange:!0},967:{countryCode:"967",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SIX,h.NINE],isRange:!0},968:{countryCode:"968",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN,h.EIGHT],isRange:!0},971:{countryCode:"971",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT,h.NINE],isRange:!0},972:{countryCode:"972",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT,h.NINE],isRange:!0},973:{countryCode:"973",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},974:{countryCode:"974",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.THREE,h.EIGHT],isRange:!0},975:{countryCode:"975",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN,h.EIGHT],isRange:!0},976:{countryCode:"976",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.SEVEN,h.EIGHT],isRange:!0},977:{countryCode:"977",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT,h.NINE],isRange:!0},979:{countryCode:"979",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},992:{countryCode:"992",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},993:{countryCode:"993",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT],isRange:!1},994:{countryCode:"994",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.EIGHT,h.NINE],isRange:!0},995:{countryCode:"995",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},996:{countryCode:"996",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1},998:{countryCode:"998",countryCodeLength:g.THREE_DIGITS,phoneNumberLengths:[h.NINE],isRange:!1}},H={1:/^1555/};class P extends v{constructor(e){super(),this.identifier="Teams_PhoneNumber",this.phoneNumberScannerOptions=this.extractPhoneNumberScannerOptions(e)}teamsShouldScan(e){let t=e.toLowerCase();if(t.length<P.MINIMUM_PHONE_NUMBER_LENGTH)return!1;let n=t.indexOf("+");return!(-1===n||!this.checkForMinimumDigits(t,n)||this.phoneNumberScannerOptions.messagePatternsToIgnoreRegex?.test(e))}teamsScan(e){let t=S(e);return this.hasValidPhoneNumber(t)}hasValidPhoneNumber(e){let t=e.indexOf("+");for(;-1!==t;){let n=this.findPhoneNumberCandidate(e,t);if(this.isValidPhoneNumber(n.trim()))return!0;t=e.indexOf("+",t+1)}return!1}isValidPhoneNumber(e){let t=this.extractPhoneNumberDigits(e);if(t.length<P.MINIMUM_PHONE_NUMBER_LENGTH||t.length>P.MAXIMUM_PHONE_NUMBER_LENGTH)return!1;let n=this.getCountryPhoneNumberLengths(t);if(0===n.length)return!1;for(let e of n)if(!this.isFakePhoneNumber(t,e)&&this.isValidPhoneNumberLength(e,t.length))return!0;return!1}isFakePhoneNumber(e,t){let n=t.countryCode;return!!H[n]&&H[n].test(e)}getCountryPhoneNumberLengths(e){let t=[];for(let n=0;n<P.MAXIMUM_COUNTRY_CODE_LENGTH;n++){let r=e.slice(0,n+1);O[r]&&t.push(O[r])}return t}extractPhoneNumberDigits(e){let t="";for(let n of e)n>="0"&&n<="9"&&(t+=n);return t}isValidPhoneNumberLength(e,t){let{countryCodeLength:n,phoneNumberLengths:r,isRange:s}=e,i=t-n;if(!s)return r.includes(i);{let[e,t]=r;return i>=e&&i<=t}}checkForMinimumDigits(e,t){let n=0;for(let r=t;r<e.length;r++){let t=e[r];if(t>="0"&&t<="9"&&n++,n>=P.MINIMUM_PHONE_NUMBER_LENGTH)return!0}return!1}findPhoneNumberCandidate(e,t){let n="";for(let r=t+1;r<e.length;r++){let t=e[r];if(t>="0"&&t<="9"||"-"===t||" "===t||"("===t||")"===t)n+=t;else break}return n}extractPhoneNumberScannerOptions(e){let t=N(this.identifier,["messagePatternsToIgnore"],e);return{messagePatternsToIgnoreRegex:Array.isArray(t.messagePatternsToIgnore)?R(t.messagePatternsToIgnore):void 0}}}P.MINIMUM_PHONE_NUMBER_LENGTH=7,P.MAXIMUM_PHONE_NUMBER_LENGTH=15,P.MAXIMUM_COUNTRY_CODE_LENGTH=3;class A extends v{constructor(e){super(),this.MRI_LIVE_PREFIX="8:live:",this.MRI_LIVE_USER_ID_CID_PREFIX=".cid.",this.MRI_LIVE_USER_ID_GUID_PREFIX="guid",this.MRI_LIVE_USER_ID_UNDEFINED="undefined",this.MIN_MRI_LIVE_ID_LENGTH=5,this.identifier="Teams_MriLive",this.mriLiveScannerOptions=this.extractMriLiveScannerOptions(e)}teamsShouldScan(e){return -1!==e.toLowerCase().indexOf(this.MRI_LIVE_PREFIX)&&!1===this.isMessageIgnored(e)}teamsScan(e){let t=S(e).toLowerCase(),[n,r]=this.findNextMriLiveCandidate(t,0);for(;void 0!==n;){for(let e of n.split(":"))if(this.isValidMriLiveUserId(e)&&!1===this.isIgnored(e))return!0;[n,r]=this.findNextMriLiveCandidate(t,r)}return!1}isValidMriLiveUserId(e){return e.length>=this.MIN_MRI_LIVE_ID_LENGTH&&!1===this.isUndefinedUserId(e)&&!1===this.isCidUserId(e)&&!1===function(e){if(0===e.length)return!1;for(let t=0;t<e.length;t++){let n=e.charCodeAt(t);if(n<48||n>57)return!1}return!0}(e)&&!1===function(e){if(0===e.length)return!1;for(let t of e)if(!C.has(t))return!1;return!0}(e)&&!1===this.isGuidUserId(e)}isUndefinedUserId(e){return e===this.MRI_LIVE_USER_ID_UNDEFINED}isCidUserId(e){return e.startsWith(this.MRI_LIVE_USER_ID_CID_PREFIX)}isGuidUserId(e){return e.startsWith(this.MRI_LIVE_USER_ID_GUID_PREFIX)||L(e)}findNextMriLiveCandidate(e,t){let n=e.indexOf(this.MRI_LIVE_PREFIX,t);if(-1===n)return[void 0,t];let r=n+this.MRI_LIVE_PREFIX.length;for(let t=r;t<e.length;t++)if(e[t]>="a"&&e[t]<="z"||e[t]>="0"&&e[t]<="9"||"."===e[t]||"-"===e[t]||"_"===e[t]||":"===e[t])r=t;else break;return[e.substring(n,r+1),r+1]}isIgnored(e){return this.mriLiveScannerOptions.mriLiveIdsToIgnoreRegex?.test(e)??!1}isMessageIgnored(e){return this.mriLiveScannerOptions.messagePatternsToIgnoreRegex?.test(e)??!1}extractMriLiveScannerOptions(e){let t=N(this.identifier,["messagePatternsToIgnore","mriLiveIdsToIgnore"],e);return{messagePatternsToIgnoreRegex:Array.isArray(t.messagePatternsToIgnore)?R(t.messagePatternsToIgnore):void 0,mriLiveIdsToIgnoreRegex:Array.isArray(t.mriLiveIdsToIgnore)?R(t.mriLiveIdsToIgnore):void 0}}}class V extends v{constructor(e){super(),this.meetingAndChannelMetadataParams=new Set(["meetingTitle=","teamAndChannelName="]),this.identifier="Teams_MeetingAndChannelsMetadata",this.scannerOptions=this.extractMeetingsAndChannelScannerOptions(e),this.scannerOptions.meetingAndChannelParamToScan&&this.scannerOptions.meetingAndChannelParamToScan.forEach(e=>{this.meetingAndChannelMetadataParams.add(e)})}teamsShouldScan(e){return!this.scannerOptions.messagePatternsToIgnoreRegex?.test(e)}teamsScan(e){return this.checkForMeetingAndChannelMetadata(e)}checkForMeetingAndChannelMetadata(e){for(let t of this.meetingAndChannelMetadataParams)if(-1!==e.indexOf(t))return!0;return!1}extractMeetingsAndChannelScannerOptions(e){let t=N(this.identifier,["messagePatternsToIgnore","meetingAndChannelParamToScan"],e);return{messagePatternsToIgnoreRegex:Array.isArray(t.messagePatternsToIgnore)?R(t.messagePatternsToIgnore):void 0,meetingAndChannelParamToScan:Array.isArray(t.meetingAndChannelParamToScan)?t.meetingAndChannelParamToScan:void 0}}}(i=u||(u={})).TeamsEmail="Teams_Email",i.TeamsFileName="Teams_FileName",i.TeamsPhoneNumber="Teams_PhoneNumber",i.TeamsMriLive="Teams_MriLive",i.TeamsMeetingAndChannelMetadata="Teams_MeetingAndChannelsMetadata";class x{constructor(){this.logSanitizerPluginInstanceMap={},this.teamsScannerIds={},this.excludedTelemetryObjects=new Set(["UserInfo","AppInfo","DeviceInfo","CommonSchema","CPUInfo","PipelineInfo","Panel","Session","Window","Action","Module","Browser","EventInfo"]),this.excludedTelemetryFields=["logLevel","logger","appId","baseData","userAgent","ext","timings","time","baseType","name","operationType","primaryUserInfoTenantId","mtmaAccounts","clientVersion"]}createLogSanitizerPluginInstance(e,t){if(!this.logSanitizerPluginInstanceMap[e]){let n=new _.z;n.setEnabled(t),this.logSanitizerPluginInstanceMap[e]=n}return this.logSanitizerPluginInstanceMap[e]}updateLogSanitizerPluginConfigInstances(e,t){let n=this.toISanitizerConfig(t,!0);Object.values(this.logSanitizerPluginInstanceMap).forEach(t=>{t.setEnabled(!1),t.updateSanitizer(n),t.setEnabled(e)})}checkAndUpdateExcludedTelemetryFields(e,t){let n=this.logSanitizerPluginInstanceMap[e]?.sanitizer,r=t.data;if(n&&r){for(let e in r)if(Object.prototype.hasOwnProperty.call(r,e)){let t=e.split(".")[0];this.excludedTelemetryObjects.has(t)&&n.addExclusion(e)}}}toISanitizerConfig(e,t){(t||0===Object.keys(this.teamsScannerIds).length)&&this.initializeTeamsScanners(e);let n=[],r=[],s=(0,m.E)();for(let t of e?.sanitize||[])t in y.k&&r.push(y.k[t]),t in this.teamsScannerIds&&r.push(this.teamsScannerIds[t]);for(let t of e?.warn||[])t in y.k&&n.push(y.k[t]),t in this.teamsScannerIds&&n.push(this.teamsScannerIds[t]);return{...s,...e,excludedPaths:this.excludedTelemetryFields,warn:n,sanitize:r}}initializeTeamsScanners(e){this.teamsScannerIds={[u.TeamsEmail]:()=>new G(e),[u.TeamsFileName]:()=>new M(e),[u.TeamsPhoneNumber]:()=>new P(e),[u.TeamsMriLive]:()=>new A(e),[u.TeamsMeetingAndChannelMetadata]:()=>new V(e)}}}let k={maxStorageSizeInBytes:5e6,storageKeyPrefix:"Teams:telemetry-instrumentation-offline-storage",minPersistenceLevel:2,eventsLimitInMem:null,inMemoMaxTime:15e3,inStorageMaxTime:1008e4,maxRetry:1,maxBatchsize:63e3,maxSentBatchInterval:15e3};(o=d||(d={}))[o.ONLINE=1]="ONLINE",o[o.OFFLINE=2]="OFFLINE",(a=l||(l={}))[a.INTERNAL=0]="INTERNAL",a[a.SERVER=1]="SERVER",a[a.CLIENT=2]="CLIENT",a[a.PRODUCER=3]="PRODUCER",a[a.CONSUMER=4]="CONSUMER";let W=["admin","Admin","ADMIN","administrator","Administrator","ADMINISTRATOR","automation","Automation","AUTOMATION","client","Client","CLIENT","limited","Limited","LIMITED","office","Office","OFFICE","services","Services","SERVICES","user","User","USER"],F={browserVer:"DeviceInfo.BrowserVersion",browserName:"DeviceInfo.BrowserName"};class U{constructor(e){this.contextManager=e,this.oneDsLoggers={},this.secondPartyLoggers={},this.oneDsManager=new c.I,this.offlineChannel=new E.p,this.sharedConfig={},this.logSanitizerPluginManager=new x,this.privacyGuardMap={},this.privacyGuardCommonContext={},this.isOnline=!0,this.offlineMinPersistenceLevel=k.minPersistenceLevel,this.forceTelemetryPaused=!1,this.statusParams={active:!0,firstPartyLoggerTokens:{},secondPartyLoggerTokens:{}}}initialize(e){this.initParams=e,this.sharedConfig={instrumentationKey:e.appTokens.default,endpointUrl:e.oneDsCollectorUrl,propertyConfiguration:{populateBrowserInfo:!0,populateOperatingSystemInfo:!0,sessionAsGuid:!0},channelConfiguration:{payloadPreprocessor:e.enableCompression?(e,t)=>{this.gzipPayload(e,t)}:void 0,eventsLimitInMem:e.eventsLimitInMem,autoFlushEventsLimit:e.eventsLimitInMem*e.autoFlushPercent,ignoreMc1Ms0CookieProcessing:!0,enableCompoundKey:!0},maxMessageLimit:0},this.sharedConfig.extensionConfig||(this.sharedConfig.extensionConfig=[]),this.sharedConfig.extensionConfig[this.offlineChannel.identifier]={providers:[3],...k,...this.initParams.applicationInsightsOfflineSettings},this.offlineMinPersistenceLevel=this.initParams.applicationInsightsOfflineSettings?.minPersistenceLevel||this.offlineMinPersistenceLevel,this.oneDsManager.create(this.sharedConfig),this.oneDsManager.getPostChannel().core.stopPollingInternalLogs?.(),this.oneDsManager.addSharedPlugin(this.offlineChannel),this.updateSDKWithOfflineTelemetry(!!this.initParams.enableOfflineTelemetry),this.initParams.enablePrivacyGuard&&this._initializePrivacyGuard(),this.contextManager.contextCallbacks["DeviceInfo.OsVersion"]=this.onOsVersion.bind(this)}updateSDKWithPrivacyGuard(e){e?this._initializePrivacyGuard():this._stopPrivacyGuard()}updateSDKWithLogSanitizer(e,t){this.logSanitizerPluginManager.updateLogSanitizerPluginConfigInstances(e,t)}updateSDKWithOfflineTelemetry(e){this.oneDsManager.getPostChannel().core.getPlugin(this.offlineChannel.identifier).setEnabled(e)}setPrivacyGuardSensitiveInformation(e){let t=e.userNames,n=e.upns;if(t){let e=new Set(this.privacyGuardCommonContext.UserNames||[]);t.filter(e=>e).forEach(t=>{e.add(t)}),this.privacyGuardCommonContext.UserNames=Array.from(e)}if(n){let e=new Set(this.privacyGuardCommonContext.UserAliases||[]);n.filter(e=>e).forEach(t=>{let n=t.split("@")[0];n&&e.add(n)}),this.privacyGuardCommonContext.UserAliases=Array.from(e)}Object.keys(this.privacyGuardMap).forEach(e=>{let t=this.privacyGuardMap[e];t&&t.updateCommonContext(this.privacyGuardCommonContext)})}start(){this.resume()}stop(){this.pause()}setOnlineState(e){this.offlineChannel.getOfflineListener().setOnlineState(e?d.ONLINE:d.OFFLINE),this.isOnline=e}setForceTelemetryPaused(e){this.forceTelemetryPaused=e}pause(){this.oneDsManager.getPostChannel().pause(),this.statusParams.active=!1,this.traceIdTimer&&clearInterval(this.traceIdTimer)}resume(){this.oneDsManager.getPostChannel().resume(),this.statusParams.active=!0}setDeviceAuthToken(e){this.initParams?.enableLoggingGlobalDeviceId&&this.oneDsManager.getPostChannel().setMsaAuthTicket(e)}flush(e,t){this.oneDsManager.getPostChannel().flush(!!t,()=>{e.postMessage("flushed")})}flushForReinit(e){let t=()=>{e.postMessage("flushedForReinit"),this.pause()};this.oneDsManager.getPostChannel().flush(!1,t)}createNewLogger(e,t){if(e&&(this.statusParams.firstPartyLoggerTokens[e]=""),e&&t&&this.initParams){let n=this.logSanitizerPluginManager.createLogSanitizerPluginInstance(e,this.initParams.enableLogSanitizer??!1),r=this.setupPrivacyGuard(t),s={extensionConfig:{[n.identifier]:this.logSanitizerPluginManager.toISanitizerConfig(this.initParams.logSanitizerConfig),[r.identifier]:{useEventFieldPrefix:!0,useAbsoluteFieldName:!0}}},i=this.oneDsManager.newInst(t,s,[n,r]);if(!i)return;i.stopPollingInternalLogs(),this.oneDsLoggers[e]=i,this.statusParams.firstPartyLoggerTokens[e]=t;let o="MSTeamsFix15SecondsProfile";this.oneDsManager.getPostChannel()._loadTransmitProfiles({[o]:[this.initParams.normalPrioritySendTimeInSecs,this.initParams.highPrioritySendTimeInSecs]}),this.oneDsManager.getPostChannel()._setTransmitProfile(o),this._handleSDKContextOverridesAtInit(i)}}logEvent(e,t,n){if(!e||!t)return;let r=this.oneDsLoggers[e];if(!r)return;let s=t.properties,i={logger:{value:e}};for(let e in s)if(Object.prototype.hasOwnProperty.call(s,e)){let t=s[e],n={value:t.value,kind:t.pii};i[e]=n}let o=new Date(t.timestamp).toISOString(),a={name:t.name,baseType:t.eventType,time:o,data:{...i,...this.contextManager.getContext(e,n)}},h=this.initParams?.eventPersistence?.[t.name]??{},g=1;if(this.forceTelemetryPaused&&a.data&&(a.data["EventInfo.TelemetryPaused"]={value:"true"}),this.forceTelemetryPaused?g=2:h?.[t.eventType]!==void 0?g=h[t.eventType]:h?.["*"]!==void 0&&(g=h["*"]),a.persistence=g,!this.isOnline&&a.data&&a.persistence>=this.offlineMinPersistenceLevel&&(a.data["EventInfo.CapturedOffline"]={value:"true"}),this.initParams?.enableDistributedTracing&&this.initParams?.distributedTracingAllowList?.includes(t.eventType)&&a.data){a.ext={...a.ext,dt:{traceId:a.data?.["EventInfo.TraceId"]?.value,spanId:a.data?.["EventInfo.SpanId"]?.value}};let e=a.data?.delta?.value||0,n=new Date(new Date(o).getTime()-e);a.baseData={...a.baseData,name:{value:t.eventType},kind:{value:l.CLIENT},time:{value:n.toISOString()},parentId:a.data?.["EventInfo.ParentSpanId"]?.value,success:a.data?.["Scenario.Status"]?.value==="success"?{value:!0}:{value:!1}},this.createSpansFromSteps(r,a,n)}this.initParams?.enableLogSanitizer&&this.logSanitizerPluginManager.checkAndUpdateExcludedTelemetryFields(e,a),r.track(a)}createNewSecondPartyLogger(e,t,n=!1){let r=this.logSanitizerPluginManager.createLogSanitizerPluginInstance(e,this.initParams?.enableLogSanitizer??!1),s=this.setupPrivacyGuard(t),i={extensionConfig:{[r.identifier]:this.logSanitizerPluginManager.toISanitizerConfig(this.initParams?.logSanitizerConfig),[s.identifier]:{useEventFieldPrefix:!0,useAbsoluteFieldName:!0}}},o=this.oneDsManager.newInst(t,i,[r,s]);o.stopPollingInternalLogs(),this.secondPartyLoggers[e]={logger:o,useTeamsContext:n},this.statusParams.secondPartyLoggerTokens[e]=t}logSecondPartyEvent(e,t){if(!e||!t)return;let n=this.secondPartyLoggers[e];n&&(n.useTeamsContext&&(t.data={...t.data,...this.contextManager.commonSchemaContextMap}),this.initParams?.enableLogSanitizer&&this.logSanitizerPluginManager.checkAndUpdateExcludedTelemetryFields(e,t),n.logger.track(t))}logSession(e,t){t.sessionId&&this.oneDsManager.getPropertyManager().getPropertiesContext().session.setId(t.sessionId)}gzipPayload(e,t){e.data=(0,T.gzip)(e.data),e.urlString+="&content-encoding=gzip",t(e)}handleSDKContextOverrides(e,t,n){if(!this.initParams?.enableSDKContextOverrides||!Object.values(F).includes(e))return;let r=n?[n]:Object.values(this.oneDsLoggers),s=t||this.contextManager.getContext(void 0)[e]?.value.toString();if(s)switch(e){case F.browserVer:r.forEach(e=>e.getOverridePropertyManager().getOverrideContext().web.setBrowserVer(s));break;case F.browserName:r.forEach(e=>e.getOverridePropertyManager().getOverrideContext().web.setBrowser(s))}}setupPrivacyGuard(e){if(!this.privacyGuardMap[e]){let t=new I.q;t.updateCommonContext({IgnoredNameParts:W,...this.privacyGuardCommonContext}),this.privacyGuardMap[e]=t}return this.initParams?.enablePrivacyGuard&&this.privacyGuardMap[e].setEnabled(!0),this.privacyGuardMap[e]}_handleSDKContextOverridesAtInit(e){Object.values(F).forEach(t=>this.handleSDKContextOverrides(t,this.contextManager.getContext(void 0)[t]?.value,e))}_initializePrivacyGuard(){this.intervalId||(this.intervalId=setInterval(()=>{Object.keys(this.privacyGuardMap).forEach(e=>{this.privacyGuardMap[e].sendSummaryEvent(!0)})},6e5))}_stopPrivacyGuard(){this.intervalId&&clearInterval(this.intervalId),Object.keys(this.privacyGuardMap).forEach(e=>{this.privacyGuardMap[e].setEnabled(!1)})}onOsVersion(e,t){this.oneDsManager.getPropertyManager().getPropertiesContext().os.ver=t}createSpansFromSteps(e,t,n){let r=t.data?.["Scenario.Steps"];if(r&&r.value){let s,i=JSON.parse(r.value);if(1===i.length)return;i.forEach(r=>{let i=JSON.parse(JSON.stringify(t)),o=`${t.baseType}_${r["Scenario.Step"]}`,a=n,h=r.delta;s&&(a=new Date(new Date(a).getTime()+s.delta),h=r.delta-s.delta),i.baseType=o,i.data={...i.data,"Scenario.Name":{value:o},delta:{value:h},elapsed:{value:r.elapsed}},i.baseData={...i.baseData,name:{value:o},time:{value:a.toISOString()},parentId:t?.ext?.dt.spanId},i.ext={...i.ext,dt:{...i.ext?.dt,spanId:this.generateSpanId()}},delete i?.data?.["Scenario.Steps"],s=r,e.track(i)})}}generateSpanId(){let e=new Uint8Array(8);return void 0!==globalThis.crypto&&globalThis.crypto.getRandomValues(e),Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}}var w=n(528165),B=n(355711);let z={"appinfo.id":"ext.app.id","appinfo.env":"ext.app.env","appinfo.version":"ext.app.ver","appinfo.versionnew":"ext.app.ver","appinfo.language":"ext.app.locale","userinfo.language":"ext.user.locale","userinfo.timezone":"ext.location.tz","userinfo.id":"ext.user.id","userinfo.tenantid":"ext.user.tenantid","deviceinfo.id":"ext.device.localid","deviceinfo.make":"ext.device.make","deviceinfo.model":"ext.device.model","deviceinfo.networktype":"ext.net.type","deviceinfo.browsername":"ext.web.browser","deviceinfo.browserversion":"ext.web.browserversion"},X="UserInfo.Id",j="AppInfo.ExpIds";class K{constructor(){this.contextMap={},this.userContextMap={},this.loggerContextMap={},this.enableMTMA=!1,this.enableMergedExpIds=!1,this.contextCallbacks={},this.commonSchemaContextMap={},this.primaryUser=""}setEnableMTMA(e){this.enableMTMA=e}setEnableMergedExpIds(e){this.enableMergedExpIds=e}setUserId(e){let t={value:e,kind:void 0};this.enableMTMA?this.setContext({key:X,value:e,userContextId:e},void 0):(this.contextMap[X]=t,this._setToCommonSchemaPropMap(X,t))}setPrimaryUser(e){!this.primaryUser&&(this.primaryUser=e,this.userContextMap[e]||(this.userContextMap[e]={}))}logOutUser(e){this.enableMTMA&&(this.userContextMap[e]={})}setContext(e,t){let n={value:e.value};this.enableMTMA&&e.userContextId?(this.userContextMap[e.userContextId]||(this.userContextMap[e.userContextId]={}),this.userContextMap[e.userContextId][e.key]=n):this.contextMap[e.key]=n,this._setToCommonSchemaPropMap(e.key,n),e.key in this.contextCallbacks&&this.contextCallbacks[e.key](e.key,e.value),t?.handleSDKContextOverrides(e.key,e.value)}getContext(e,t){return t=t&&t.length>0?t:this.primaryUser,{...this._getMainContext(t),...this._getLoggerContext(e,t)}}setLoggerContext(e,t){if(e.logger&&(this.loggerContextMap[e.logger]||(this.loggerContextMap[e.logger]={baseMap:{},userMap:{}}),t.has(e.key))){let t={value:e.value};e.key===j&&this.enableMergedExpIds&&(t.value=this._joinExpIds(this.contextMap[j]?.value,e.value)),this.enableMTMA&&e.userContextId?(this.loggerContextMap[e.logger].userMap[e.userContextId]||(this.loggerContextMap[e.logger].userMap[e.userContextId]={}),this.loggerContextMap[e.logger].userMap[e.userContextId][e.key]=t):this.loggerContextMap[e.logger].baseMap[e.key]=t,e.key in this.contextCallbacks&&this.contextCallbacks[e.key](e.key,e.value)}}_getLoggerContext(e,t){return e?(this.loggerContextMap[e]||(this.loggerContextMap[e]={baseMap:{},userMap:{}}),{...this.loggerContextMap[e].baseMap,...t&&t.length&&this.enableMTMA?this.loggerContextMap[e].userMap[t]:{}}):{}}_getMainContext(e){return{...this.contextMap,...e&&e.length&&this.enableMTMA?this.userContextMap[e]:{}}}_joinExpIds(e,t){return e||t?!e&&t?t:e&&!t?e:Array.from(new Set([...e.split(","),...t.split(",")])).join(","):""}_setToCommonSchemaPropMap(e,t){let n=z[e.toLowerCase()];n&&(this.commonSchemaContextMap[n]=t)}}class q{constructor(){this.enableOneDsSdk=!1,this.existingTransports={},this.secondPartyLoggers={},this.firstPartyLoggers={},this.delayedTransportCallbacks=[],this.contextManager=new K,this.liteExperienceChannels={},this.performanceObserverCallback=e=>{this.router?.postMessage("onPerformanceObserverEntries",JSON.stringify(e.getEntries()))}}initialize(e){if(e)this.router=e;else throw Error("WebWorkerRouter did not exist.");this._registerMessageHandlers(e)}setupFirstPartyRouter(e,t){e.registerMessageHandler("initialize",t=>{this.telemetryTransport?e.postMessage("workerInitialized"):this.delayedTransportCallbacks.push(()=>e.postMessage("workerInitialized"))}),e.registerMessageHandler("newLogger",e=>{this.telemetryTransport?.createNewLogger(e.key,e.value),this.firstPartyLoggers[e.key]=e.value}),e.registerMessageHandler("logEvent",e=>{this.telemetryTransport?.logEvent(e.key,e.value,e.userContextId)}),e.registerMessageHandler("setContext",e=>{let{contextFilter:n}=t;this.contextManager.setLoggerContext(e,n)})}Verbose(e){this.router&&this.router.postMessage("verbose",e)}Error(e){this.router&&this.router.postMessage("error",e)}Info(e){this.router&&this.router.postMessage("info",e)}channelPortMessageHandlers(e,t,n,r){switch(e){case"initialize":this.telemetryTransport?t.postMessage({name:"workerInitialized",params:void 0}):this.delayedTransportCallbacks.push(()=>t.postMessage({name:"workerInitialized",params:void 0}));break;case"batch":for(let e of r)e&&e.name&&this.channelPortMessageHandlers(e.name,t,n,e?.params);t.postMessage({name:"batchDone",params:void 0});break;case"logEvent":r&&this.telemetryTransport?.logEvent(n??r.key,r.value,r.userContextId);break;case"setContext":r&&(r.logger=n,this.contextManager.setLoggerContext(r,B.PL));break;case"newLogger":r&&(this.telemetryTransport?.createNewLogger(r.key,r.value),this.firstPartyLoggers[r.key]=r.value)}}registerMessageChannelPort(e,t){let n=t=>{this.channelPortMessageHandlers(t.data.operation,e,t.data.channel,t.data.params)};e.onmessage=n.bind(this),this.liteExperienceChannels[t]=e}_registerMessageHandlers(e){e.registerMessageHandler("initialize",t=>{this.initTelemetryTransport(t),e.postMessage("workerInitialized")}),e.registerMessageHandler("start",()=>{this.telemetryTransport?.start()}),e.registerMessageHandler("stop",()=>{this.telemetryTransport?.stop()}),e.registerMessageHandler("flush",t=>{this.telemetryTransport?.flush(e,t?.isAsync)}),e.registerMessageHandler("flushForReinit",t=>{this.reinitTelemetryTransport(t,e)}),e.registerMessageHandler("newLogger",e=>{this.telemetryTransport?.createNewLogger(e.key,e.value),this.firstPartyLoggers[e.key]=e.value}),e.registerMessageHandler("logEvent",e=>{this.telemetryTransport?.logEvent(e.key,e.value,e.userContextId)}),e.registerMessageHandler("newSecondPartyOneDsLogger",e=>{this.createSecondPartyLogger(e.key,e.value.ingestionToken,e.value.useTeamsContext)}),e.registerMessageHandler("setupChannelMessengerPort",e=>{this.registerMessageChannelPort(e.port,e.identifier)}),e.registerMessageHandler("teardownChannelMessengerPort",e=>{delete this.liteExperienceChannels[e.identifier]}),e.registerMessageHandler("setPrimaryUser",e=>{this.contextManager.setPrimaryUser(e.userContextId)}),e.registerMessageHandler("logSecondPartyEvent",e=>{this.telemetryTransport?.logSecondPartyEvent(e.key,e.value)}),e.registerMessageHandler("logSession",t=>{this.telemetryTransport?.logSession(e,t)}),e.registerMessageHandler("setUserId",e=>{this.contextManager.setUserId(e)}),e.registerMessageHandler("setDeviceAuthToken",e=>{this.telemetryTransport?.setDeviceAuthToken(e)}),e.registerMessageHandler("setContext",e=>{this.contextManager.setContext(e,this.telemetryTransport)}),e.registerMessageHandler("setPrivacyGuardUserInfo",e=>{this.enableOneDsSdk&&this.telemetryTransport?.setPrivacyGuardSensitiveInformation(e)}),e.registerMessageHandler("updateSDKWithPrivacyGuard",e=>{this.enableOneDsSdk&&this.telemetryTransport?.updateSDKWithPrivacyGuard(e)}),e.registerMessageHandler("updateSDKWithLogSanitizer",e=>{this.enableOneDsSdk&&this.telemetryTransport?.updateSDKWithLogSanitizer(e.flag,e.logSanitizerConfig)}),e.registerMessageHandler("updateSDKWithOfflineTelemetry",e=>{this.enableOneDsSdk&&this.telemetryTransport?.updateSDKWithOfflineTelemetry(e)}),e.registerMessageHandler("logOutUser",e=>{this.contextManager?.logOutUser(e)}),e.registerMessageHandler("setPausedTelemetryPersistenceLevel",()=>{this.telemetryTransport?.setForceTelemetryPaused(!0)}),e.registerMessageHandler("resetPausedTelemetryPersistenceLevel",()=>{this.telemetryTransport?.setForceTelemetryPaused(!1)}),e.registerMessageHandler("setOnlineState",async e=>{this.telemetryTransport?.setOnlineState(e)}),e.registerMessageHandler("startPerformanceObserver",async()=>{this.performanceObserver||(this.performanceObserver=new PerformanceObserver(this.performanceObserverCallback),this.performanceObserver.observe({type:"resource"}))}),e.registerMessageHandler("stopPerformanceObserver",async()=>{this.performanceObserver&&(this.performanceObserver.disconnect(),this.performanceObserver=void 0)})}createSecondPartyLogger(e,t,n){this.secondPartyLoggers[e]={token:t,useTeamsContext:n},this.telemetryTransport?.createNewSecondPartyLogger(e,t,n)}reinitTelemetryTransport(e,t){this.telemetryTransport?.flushForReinit(t);let n=e.oneDsCollectorUrl||"",r=this.existingTransports[n];r?r.statusParams.active?this.telemetryTransport=r:(this.telemetryTransport=r,Object.keys(this.firstPartyLoggers).forEach(e=>{this.telemetryTransport?.statusParams.firstPartyLoggerTokens[e]&&this.telemetryTransport?.statusParams.firstPartyLoggerTokens[e]===this.firstPartyLoggers[e]||this.telemetryTransport?.createNewLogger(B.hy[e],this.firstPartyLoggers[e])}),Object.keys(this.secondPartyLoggers).forEach(e=>{this.telemetryTransport?.statusParams.secondPartyLoggerTokens[e]&&this.telemetryTransport?.statusParams.secondPartyLoggerTokens[e]===this.secondPartyLoggers[e].token||this.telemetryTransport?.createNewSecondPartyLogger(e,this.secondPartyLoggers[e].token,this.secondPartyLoggers[e].useTeamsContext)}),this.telemetryTransport.start()):(this.initTelemetryTransport(e),this.telemetryTransport?.createNewLogger(e.defaultLoggerName||B.hy.default,e.appTokens.default),this.telemetryTransport?.logSession(t,{name:e.defaultLoggerName||B.hy.default,state:w.sM.STARTED,sessionId:e.sessionId,sessionStartTime:e.sessionStartTime}),Object.keys(this.firstPartyLoggers).forEach(e=>{this.telemetryTransport?.createNewLogger(B.hy[e],this.firstPartyLoggers[e])}),Object.keys(this.secondPartyLoggers).forEach(e=>{this.telemetryTransport?.createNewSecondPartyLogger(e,this.secondPartyLoggers[e].token,this.secondPartyLoggers[e].useTeamsContext)}))}initTelemetryTransport(e){this.contextManager.setEnableMTMA(!!e.enableMTMA),this.contextManager.setEnableMergedExpIds(!!e.enableMergedExpIds),e.enableDebugTrace?e.config.log=this:e.config.log=void 0,this.enableOneDsSdk=!0,this.telemetryTransport=new U(this.contextManager),this.existingTransports[e.oneDsCollectorUrl||"defaultOneDsUrl"]=this.telemetryTransport,this.telemetryTransport.initialize(e),this.delayedTransportCallbacks.length>0&&(this.delayedTransportCallbacks.forEach(e=>{e()}),this.delayedTransportCallbacks=[]),Object.keys(this.liteExperienceChannels).forEach(e=>this.liteExperienceChannels[e].postMessage("workerInitialized"))}}},703575:function(e,t,n){n.d(t,{t:()=>r});class r{constructor(){this.messageHandlers={},this.registerMessageHandler("batch",e=>{for(let t of e)if(t&&t.name){let e=this.messageHandlers[t.name];e&&e(t.params)}this.postMessage("batchDone")})}registerMessageHandler(e,t){if(this.messageHandlers[e])return void console.warn(`message handler already registered for - ${e}`);this.messageHandlers[e]=t}unregisterMessageHandler(e){delete this.messageHandlers[e]}}},659206:function(e,t,n){var r,s,i,o;n.d(t,{V:()=>r}),(i=r||(r={}))[i.BT_STOP=0]="BT_STOP",i[i.BT_STOP_BASE=1]="BT_STOP_BASE",i[i.BT_BOOL=2]="BT_BOOL",i[i.BT_UINT8=3]="BT_UINT8",i[i.BT_UINT16=4]="BT_UINT16",i[i.BT_UINT32=5]="BT_UINT32",i[i.BT_UINT64=6]="BT_UINT64",i[i.BT_FLOAT=7]="BT_FLOAT",i[i.BT_DOUBLE=8]="BT_DOUBLE",i[i.BT_STRING=9]="BT_STRING",i[i.BT_STRUCT=10]="BT_STRUCT",i[i.BT_LIST=11]="BT_LIST",i[i.BT_SET=12]="BT_SET",i[i.BT_MAP=13]="BT_MAP",i[i.BT_INT8=14]="BT_INT8",i[i.BT_INT16=15]="BT_INT16",i[i.BT_INT32=16]="BT_INT32",i[i.BT_INT64=17]="BT_INT64",i[i.BT_WSTRING=18]="BT_WSTRING",i[i.BT_UNAVAILABLE=127]="BT_UNAVAILABLE",(o=s||(s={}))[o.MARSHALED_PROTOCOL=0]="MARSHALED_PROTOCOL",o[o.MAFIA_PROTOCOL=17997]="MAFIA_PROTOCOL",o[o.COMPACT_PROTOCOL=16963]="COMPACT_PROTOCOL",o[o.JSON_PROTOCOL=21322]="JSON_PROTOCOL",o[o.PRETTY_JSON_PROTOCOL=20554]="PRETTY_JSON_PROTOCOL",o[o.SIMPLE_PROTOCOL=20563]="SIMPLE_PROTOCOL"},64388:function(e,t,n){n.d(t,{D:()=>r});class r{constructor(){this._buffer=[]}Add(e,t){-1==this._getIndex(e)&&this._buffer.push({Key:e,Value:t})}AddOrReplace(e,t){var n=this._getIndex(e);n>=0?this._buffer[n]={Key:e,Value:t}:this._buffer.push({Key:e,Value:t})}Remove(e){var t=this._getIndex(e);t>=0&&this._buffer.splice(t,1)}Count(){return this._buffer.length}GetBuffer(){return this._buffer}ContainsKey(e){return this._getIndex(e)>=0}Get(e){var t=this._getIndex(e);return t>=0?this._buffer[t].Value:null}_getIndex(e){for(var t=0,n=-1;t<this._buffer.length;++t)if(this._buffer[t].Key==e){n=t;break}return n}}},620236:function(e,t,n){n.d(t,{KS:()=>g,Mr:()=>a,Pp:()=>h,ni:()=>i,rH:()=>u,zM:()=>o});var r=n(659206),s=n(102659);class i{constructor(e){this.low=0,this.high=0,this.low=parseInt(e),this.low<0&&(this.high=-1)}Equals(e){var t=new i(e);return this.low==t.low&&this.high==t.high}}class o{constructor(e){this.low=0,this.high=0,this.low=parseInt(e)}Equals(e){var t=new o(e);return this.low==t.low&&this.high==t.high}}class a{static ToByte(e){return this.ToUInt8(e)}static ToInt8(e){return 127&e|(128&e)<<24>>24}static ToInt16(e){return 32767&e|(32768&e)<<16>>16}static ToInt32(e){return 0x7fffffff&e|0x80000000&e}static ToUInt8(e){return 255&e}static ToUInt16(e){return 65535&e}static ToUInt32(e){return 0|e}}class h{constructor(e){this.Message=e}}class g{static IsDataViewSupport(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView}}class u{constructor(e){this._stream=e}WriteBlob(e){this._stream.Write(e,0,e.length)}WriteBool(e){this._stream.WriteByte(+!!e)}WriteContainerBegin(e,t){this.WriteUInt8(t),this.WriteUInt32(e)}WriteMapContainerBegin(e,t,n){this.WriteUInt8(t),this.WriteUInt8(n),this.WriteUInt32(e)}WriteContainerEnd(){}WriteDouble(e){var t=s.bh.GetBytes(e);this._stream.Write(t,0,t.length)}WriteFloat(e){var t=s.bv.GetBytes(e);this._stream.Write(t,0,t.length)}WriteFieldBegin(e,t,n){t<=5?this._stream.WriteByte(e|t<<5):t<=255?(this._stream.WriteByte(192|e),this._stream.WriteByte(t)):(this._stream.WriteByte(224|e),this._stream.WriteByte(t),this._stream.WriteByte(t>>8))}WriteFieldEnd(){}WriteFieldOmitted(e,t,n){}WriteInt16(e){e=s.if.EncodeZigzag16(e),this.WriteUInt16(e)}WriteInt32(e){e=s.if.EncodeZigzag32(e),this.WriteUInt32(e)}WriteInt64(e){this.WriteUInt64(s.if.EncodeZigzag64(e))}WriteInt8(e){this._stream.WriteByte(a.ToInt8(e))}WriteString(e){if(""==e)this.WriteUInt32(0);else{var t=s.di.GetBytes(e);this.WriteUInt32(t.length),this._stream.Write(t,0,t.length)}}WriteStructBegin(e,t){}WriteStructEnd(e){this.WriteUInt8(e?r.V.BT_STOP_BASE:r.V.BT_STOP)}WriteUInt16(e){var t=s.Km.GetBytes(a.ToUInt16(e));this._stream.Write(t,0,t.length)}WriteUInt32(e){var t=s.Km.GetBytes(a.ToUInt32(e));this._stream.Write(t,0,t.length)}WriteUInt64(e){var t=s.Ms.GetBytes(e);this._stream.Write(t,0,t.length)}WriteUInt8(e){this._stream.WriteByte(a.ToUInt8(e))}WriteWString(e){this.WriteUInt32(e.length);for(var t=0;t<e.length;++t){var n=e.charCodeAt(t);this._stream.WriteByte(n),this._stream.WriteByte(n>>>8)}}}},298120:function(e,t,n){n.d(t,{$L:()=>c,A4:()=>h,P6:()=>d,Pm:()=>l});var r,s,i,o,a,h,g=n(620236),u=n(659206);class d{static GetGuid(){var e=function(){return Math.floor((1+Math.random())*65536).toString(16).substring(1,5)};return""+e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}static GetTimeStamp(){var e=new Date().getTime(),t=new g.ni("0");return t.low=0|e,t.high=Math.floor(e/0x100000000),t}static GetTimeStampWithValue(e){var t=new g.ni("0");return t.low=0|e,t.high=Math.floor(e/0x100000000),t}}(r=o||(o={}))[r.NotSet=0]="NotSet",r[r.Event=1]="Event",r[r.PerformanceCounter=2]="PerformanceCounter",r[r.Anomaly=3]="Anomaly",r[r.Prediction=4]="Prediction",r[r.TraceLog=5]="TraceLog",r[r.EventSourceLog=6]="EventSourceLog",r[r.HttpLog=7]="HttpLog",r[r.PerformanceCounterAzure=8]="PerformanceCounterAzure",r[r.PerformanceCounterGfs=9]="PerformanceCounterGfs",(s=a||(a={}))[s.NotSet=0]="NotSet",s[s.O365=1]="O365",s[s.SkypeBI=2]="SkypeBI",s[s.SkypeData=3]="SkypeData",(i=h||(h={}))[i.NotSet=0]="NotSet",i[i.DistinguishedName=1]="DistinguishedName",i[i.GenericData=2]="GenericData",i[i.IPV4Address=3]="IPV4Address",i[i.IPv6Address=4]="IPv6Address",i[i.MailSubject=5]="MailSubject",i[i.PhoneNumber=6]="PhoneNumber",i[i.QueryString=7]="QueryString",i[i.SipAddress=8]="SipAddress",i[i.SmtpAddress=9]="SmtpAddress",i[i.Identity=10]="Identity",i[i.Uri=11]="Uri",i[i.Fqdn=12]="Fqdn",i[i.IPV4AddressLegacy=13]="IPV4AddressLegacy",i[i.FilePath=14]="FilePath";class l{constructor(){this.Source="",this.DataPackageId="",this.Timestamp=new g.ni("0"),this.Records=[]}Write(e){this.WriteImpl(e,!1)}WriteImpl(e,t){if(e.WriteStructBegin(null,t),""!=this.Source?(e.WriteFieldBegin(u.V.BT_STRING,2,null),e.WriteString(this.Source),e.WriteFieldEnd()):e.WriteFieldOmitted(u.V.BT_STRING,2,null),""!=this.DataPackageId?(e.WriteFieldBegin(u.V.BT_STRING,5,null),e.WriteString(this.DataPackageId),e.WriteFieldEnd()):e.WriteFieldOmitted(u.V.BT_STRING,5,null),this.Timestamp.Equals("0")?e.WriteFieldOmitted(u.V.BT_INT64,6,null):(e.WriteFieldBegin(u.V.BT_INT64,6,null),e.WriteInt64(this.Timestamp),e.WriteFieldEnd()),this.Records.length){e.WriteFieldBegin(u.V.BT_LIST,8,null),e.WriteContainerBegin(this.Records.length,u.V.BT_STRUCT);for(var n=0;n<this.Records.length;++n)this.Records[n].WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(u.V.BT_LIST,8,null);e.WriteStructEnd(t)}Read(e){this.ReadImpl(e,!1)}ReadImpl(e,t){}}class c{constructor(){this.DataPackages=[],this.RequestRetryCount=0}Write(e){this.WriteImpl(e,!1)}WriteImpl(e,t){if(e.WriteStructBegin(null,t),this.DataPackages.length){e.WriteFieldBegin(u.V.BT_LIST,1,null),e.WriteContainerBegin(this.DataPackages.length,u.V.BT_STRUCT);for(var n=0;n<this.DataPackages.length;++n)this.DataPackages[n].WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(u.V.BT_LIST,1,null);0!=this.RequestRetryCount?(e.WriteFieldBegin(u.V.BT_INT32,2,null),e.WriteInt32(this.RequestRetryCount),e.WriteFieldEnd()):e.WriteFieldOmitted(u.V.BT_INT32,2,null),e.WriteStructEnd(t)}Read(e){this.ReadImpl(e,!1)}ReadImpl(e,t){}}},479888:function(e,t,n){n.d(t,{Mk:()=>N,sE:()=>R});var r,s,i,o,a,h,g,u,d,l,c,I,E=n(298120);class T{static IsSafariOrFirefox(){return null===T._isSafariOrFirefox&&T._DetectBrowser(),T._isSafariOrFirefox}static ajax(e){var t=T._createConnection();if(e.headers){var n="qsp=true";for(var r in e.headers)n+="&",n+=encodeURIComponent(r),n+="=",n+=encodeURIComponent(e.headers[r]);0>e.url.indexOf("?")?e.url+="?":e.url+="&",e.url+=n}t.open(e.type,e.url),e.complete&&(t.onload=()=>{void 0===t.status&&(t.status=200),e.complete(t)},t.ontimeout=()=>{void 0===t.status&&(t.status=500),e.complete(t)},t.onerror=()=>{e.complete(t)}),t.send(e.data)}static keys(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}static IsUsingXDomainRequest(){return null==T._usingXDomainRequest&&(void 0===new XMLHttpRequest().withCredentials&&"undefined"!=typeof XDomainRequest?T._usingXDomainRequest=!0:T._usingXDomainRequest=!1),T._usingXDomainRequest}static _createConnection(){var e=new XMLHttpRequest;return T.IsUsingXDomainRequest()?new XDomainRequest:e}static _DetectBrowser(){var e=navigator.userAgent.toLowerCase();(e.indexOf("safari")>=0||e.indexOf("firefox")>=0)&&0>e.indexOf("chrome")?T._isSafariOrFirefox=!0:T._isSafariOrFirefox=!1}}T._isSafariOrFirefox=null,T._usingXDomainRequest=null;var _=n(102659),m=n(620236);class y{constructor(){this._buffer=[]}WriteByte(e){this._buffer.push(m.Mr.ToByte(e))}Write(e,t,n){for(;n--;)this.WriteByte(e[t++])}GetBuffer(){return this._buffer}}class p{constructor(){this.data=[]}WriteBlob(e){this.data.push({type:"blob",value:e})}WriteBool(e){this.data.push({type:"boolean",value:e})}WriteContainerBegin(e,t){this.data.push({type:"containerBegin",size:e,elementType:t})}WriteMapContainerBegin(e,t,n){this.data.push({type:"mapContainerBegin",size:e,keyType:t,valueType:n})}WriteContainerEnd(){this.data.push({type:"containerEnd"})}WriteDouble(e){this.data.push({type:"number",value:e})}WriteFloat(e){this.data.push({type:"number",value:e})}WriteFieldBegin(e,t,n){this.data.push({type:"fieldBegin",id:t})}WriteFieldEnd(){this.data.push({type:"fieldEnd"})}WriteFieldOmitted(e,t,n){this.data.push({type:"fieldOmitted",id:t})}WriteInt16(e){this.data.push({type:"number",value:e})}WriteInt32(e){this.data.push({type:"number",value:e})}WriteInt64(e){let t={type:"number",value:0x100000000*e.high+e.low};this.data.push(t)}WriteInt8(e){this.data.push({type:"number",value:e})}WriteString(e){this.data.push({type:"string",value:e})}WriteStructBegin(e,t){this.data.push({type:"structBegin",isBase:t})}WriteStructEnd(e){this.data.push({type:"structEnd",isBase:e})}WriteUInt16(e){this.data.push({type:"number",value:e})}WriteUInt32(e){this.data.push({type:"number",value:e})}WriteUInt64(e){this.data.push({type:"number",value:e})}WriteUInt8(e){this.data.push({type:"number",value:e})}WriteWString(e){this.data.push({type:"string",value:e})}}(r=g||(g={}))[r.ECS_ERROR_OK=0]="ECS_ERROR_OK",r[r.ECS_ERROR_INVALID_STATUS=1]="ECS_ERROR_INVALID_STATUS",r[r.ECS_ERROR_INVALID_RESPONSE=6]="ECS_ERROR_INVALID_RESPONSE",r[r.ECS_ERROR_INVALID_CONFIG=8]="ECS_ERROR_INVALID_CONFIG",(s=u||(u={}))[s.CONFIG_UPDATED=0]="CONFIG_UPDATED",s[s.TOKEN_IS_INVALID=1]="TOKEN_IS_INVALID";class C{}C.Servers=["https://config.teams.microsoft.com/config/v1/Skype/"],C.RefreshIntervalInMS=36e5,C.FailedRetryFactorInMS=1e4,C.MaxRetryIntervalForFailedInMS=36e5,(i=d||(d={}))[i.Created=0]="Created",i[i.Initialized=1]="Initialized",i[i.Started=2]="Started",i[i.Loading=3]="Loading";class L{static get version(){return"2.5.0"}}(o=l||(l={}))[o.SENT=0]="SENT",o[o.SEND_FAILED=1]="SEND_FAILED",(a=c||(c={}))[a.DATARV_ERROR_OK=0]="DATARV_ERROR_OK",a[a.DATARV_ERROR_INVALID_EVENT=1]="DATARV_ERROR_INVALID_EVENT",a[a.DATARV_ERROR_INVALID_CONFIG=2]="DATARV_ERROR_INVALID_CONFIG",a[a.DATARV_ERROR_INVALID_DEPENDENCIES=3]="DATARV_ERROR_INVALID_DEPENDENCIES",a[a.DATARV_ERROR_INVALID_STATUS=4]="DATARV_ERROR_INVALID_STATUS",a[a.DATARV_ERROR_INVALID_ARG=5]="DATARV_ERROR_INVALID_ARG";class S{constructor(e){this._errorCode=c.DATARV_ERROR_OK,this._errorCode=e}ErrorCode(){return this._errorCode}toString(){switch(this._errorCode){case c.DATARV_ERROR_OK:return"DATARV_ERROR_OK";case c.DATARV_ERROR_INVALID_EVENT:return"Event is invalid. Either event.Id is empty, or event.Timestamp is empty, or event.EventType is empty.";case c.DATARV_ERROR_INVALID_CONFIG:return"Invalid configuration. CollectorUrl is missing.";case c.DATARV_ERROR_INVALID_DEPENDENCIES:return"DATARV_ERROR_INVALID_DEPENDENCIES";case c.DATARV_ERROR_INVALID_STATUS:return"Telemetry Manager is not initialized.";case c.DATARV_ERROR_INVALID_ARG:return"TenantToken is null or empty, or events is null.";default:return"Unknown error"}}}class N{constructor(){this.eventsLimitInMem=1e4}}class R{static CreateTelemetryManager(){return new b}}class f{}f.MaxPackageSizeInBytes=3e6,f.TimeIntervalForNextSendInMS=15e3,(h=I||(I={}))[h.Created=0]="Created",h[h.Initialized=1]="Initialized",h[h.Started=2]="Started";class b{constructor(){this._MaxPackageSizeInBytes=f.MaxPackageSizeInBytes,this._listeners=[],this._status=I.Created,this._ecsClient=null,this._etag=null,this._ecsCallback=null,this._testServerResponseHook=null,this._testHookListeners=[]}Initialize(e){if(this._status!=I.Created)throw new S(c.DATARV_ERROR_INVALID_STATUS);if(!e||!e.collectorUrl)throw new S(c.DATARV_ERROR_INVALID_CONFIG);this._config=e,this._Reset(),this._status=I.Initialized,e.ecsClient&&(this._Verbose("ECS object assigned. Do integration"),this._ecsClient=e.ecsClient),e.overwriteSendTimeInterval&&e.overwriteSendTimeInterval>=0&&(f.TimeIntervalForNextSendInMS=e.overwriteSendTimeInterval),this._Verbose("Initialize() done")}setEventsLimitInMem(e){this._eventsCache.setEventsLimitInMem(e)}AddListener(e){if(this._status<I.Initialized)throw new S(c.DATARV_ERROR_INVALID_STATUS);this._Verbose("AddListener(), status: "+this._status+" old length: "+this._listeners.length+" func: "+e);for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return void this._Verbose("the listener has been added already, index: "+t);this._listeners.push(e),this._Verbose("AddListener() done, the new length: "+this._listeners.length)}RemoveListener(e){if(this._status<I.Initialized)throw new S(c.DATARV_ERROR_INVALID_STATUS);this._Verbose("RemoveListener(), status: "+this._status+" old length: "+this._listeners.length+" func: "+e);for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e){1==this._listeners.length?this._listeners=[]:t==this._listeners.length-1?this._listeners.pop():this._listeners[t]=this._listeners.pop(),this._Verbose("this listener has been found, index: "+t+"new length: "+this._listeners.length);return}this._Verbose("listener isn't been found, new length"+this._listeners.length)}Start(){if(this._status<I.Initialized)throw new S(c.DATARV_ERROR_INVALID_STATUS);this._Verbose(["Start(), status:",this._status,"tag:",b._tag].join(" ")),this._status>=I.Started&&this._Verbose("Start() already, ignore"),this._ecsClient&&(this._ecsCallback=this._CreateEcsCallback(),this._ecsClient.AddListener(this._ecsCallback),this._etag=this._ecsClient.GetETag()),++b._tag,this._status=I.Started,this._Verbose("Start() done, status: "+this._status+"tag: "+b._tag)}Stop(){if(this._status<I.Initialized)throw new S(c.DATARV_ERROR_INVALID_STATUS);if(this._Verbose("Stop(), status: "+this._status),this._status==I.Initialized)return void this._Verbose("Stop() already, ignore");this._Reset(),this._status=I.Initialized,this._Verbose("Stop() done, status: "+this._status)}Flush(e){this._eventsCache.IsEmpty()||this._WorkThread(e)}SendAsync(e,t){if(this._status<I.Initialized)throw new S(c.DATARV_ERROR_INVALID_STATUS);if(this._Verbose(["SendAsync(), status:",this._status,"tenantToken:",e,"count:",t.length].join(" ")),this._status<I.Started)return this._Info("SendAsync(), not started, ignore, return false"),!1;if(!e||!t)throw this._Error("SendAsync(), tenantToken or events is null or empty"),new S(c.DATARV_ERROR_INVALID_ARG);for(var n=0;n<t.length;++n)if(!t[n].Id||!b._eventTypeRegex.test(t[n].EventType)||t[n].Timestamp.Equals("0"))throw this._Error("eventId:"+t[n].Id+"eventType:"+t[n].EventType+"timestamp high:"+t[n].Timestamp.high+"timestamp low:"+t[n].Timestamp.low),new S(c.DATARV_ERROR_INVALID_EVENT);return this._eventsCache?.AddEvents(e,t),this._Verbose(["SendAsync(), currentTimer: ",this._timer,"eventsCacheIsEmpty",this._eventsCache.IsEmpty()].join(" ")),this._eventsCache.IsEmpty()||this._timer||this._ScheduleTimer(!1),this._Verbose("SendAsync() done"),!0}_WorkThread(e){try{var t=Date.now();if(this._Verbose("_WorkThread, status: "+this._status),this._status<I.Started)return void this._Verbose("_WorkThread, status is not started, return");var n=this._eventsCache.DequeuEvents();if(null==n){this._Verbose("_WorkThread, No events found, return"),this._CleanTimer();return}var r=n.events.length,s=this._PackEvents(n.tenantToken,n.events);this._eventsCache?.AddEvents(n.tenantToken,s.remainedEvents);var i=s.remainedEvents.length;if(null==s.buffer||0==s.buffer.length)return void(this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1)));if(this._testHookListeners)for(var o=0;o<this._testHookListeners.length;++o)this._testHookListeners[o](s.sendEvents);if(this._testServerResponseHook){var a=this._testServerResponseHook();setTimeout(()=>this._SendCallback(g,n.tenantToken,s.sendEvents,a,null),100);return}var h={type:"POST",url:this._config.collectorUrl,processData:!1,headers:{"content-type":"application/bond-compact-binary","client-id":"NO_AUTH","sdk-version":"ACT-Web-JS-"+L.version},complete:t=>this._SendCallback(g,n.tenantToken,s.sendEvents,t,e)};this._config.useJsonTextStream?(h.data=s.buffer,h.headers["content-type"]="application/json"):T.IsSafariOrFirefox()||"undefined"==typeof Uint8Array?(this._Verbose("Uint8Array is undefined, send with base64 encode."),h.data=_.DS.GetString(s.buffer),h.headers["content-encoding"]="base64"):(this._Verbose("Uint8Array is defined, send with binary format directly."),h.data=new Uint8Array(s.buffer)),n.tenantToken&&(h.headers["x-apikey"]=n.tenantToken);var g=b._tag;this._lastActiveTime=new Date().getTime(),T.ajax(h),this._Verbose("_Workthread, send via jquery, tag: "+g),this._Info("Processing telemetry events took "+(Date.now()-t)+" ms for "+(r-i)+" events with total size of "+s.buffer.length+" bytes, remaining events - "+i)}catch(e){this._Error("_WorkThread, exception: "+e)}}_PackEvents(e,t){this._Verbose("_PackageEvents, total Count: "+t.length);var n,r=new E.$L,s=new E.Pm;s.Source="JS_default_source",s.DataPackageId=E.P6.GetGuid(),s.Timestamp=E.P6.GetTimeStamp();var i=t;if(t=[],i.length>200){var o=i.splice(0,200);t.push.apply(t,i),i=o}for(;s.Records=[],s.Records.push.apply(s.Records,i),r.DataPackages=[],r.DataPackages.push(s),n=this._Serialize(r),this._Verbose("_PackageEvents, sendEvents.length:"+i.length+" buffer.length:"+n.length+" MaxPackageSize:"+this._MaxPackageSizeInBytes),!(n.length<this._MaxPackageSizeInBytes);){if(1==i.length){i=[],n=null;break}var a=i.splice(0,Math.floor(i.length/2));this._Verbose("_PackageEvents, too large, package again"),t.push.apply(t,i),i=a}return this._Verbose("_PakcageEvents done, sendEventsCount:"+i.length+"buffer.length:"+(null==n?0:n.length)+"remained events:"+t.length),{buffer:n,sendEvents:i,remainedEvents:t}}_Serialize(e){if(this._config.useJsonTextStream){var t=new p;return e.Write(t),JSON.stringify(t.data)}var n=new y,r=new m.rH(n);return e.Write(r),n.GetBuffer()}_SendCallback(e,t,n,r,s){if(this._Verbose("_SendCallbacktag:"+e+"current tag:"+b._tag+"tenantToken:"+t+"events count:"+n.length+"jqXHR:"+r),null!=s)return void s(r?r.status:0,t,n);var i=null!=r&&r.status>=200&&r.status<300;if(this._status<I.Started||e<b._tag)return void this._Verbose("_SendCallback, is not started, or tag is not the same, return");if(!i&&(!r||400!=r.status)){this._Verbose("retry statusCode: "+(r?r.status:0)),this._eventsCache?.AddEvents(t,n),this._ScheduleTimer(!0);return}for(var o=0;o<this._listeners.length;++o)this._listeners[o](i?l.SENT:l.SEND_FAILED,r?r.status:0,t,n);this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1))}_CleanTimer(){this._Verbose("_CleanTimer(), timer: "+this._timer),this._timer&&(clearTimeout(this._timer),this._timer=null)}_ScheduleTimer(e){if(this._Verbose("_ScheduleTimer: isRetry: "+e),this._CleanTimer(),e){this._Verbose("_ScheduleTimer, current factor: "+this._rescheduleFactor);var t=Math.floor(5*this._rescheduleFactor*(1+Math.random()));this._timer=setTimeout(()=>this._WorkThread(null),1e3*t),this._Verbose("_ScheduleTimer, next try (s): "+t),this._rescheduleFactor<<=1,this._rescheduleFactor>64&&(this._rescheduleFactor=1)}else{var t=0,n=new Date().getTime()-this._lastActiveTime;t=n>f.TimeIntervalForNextSendInMS?0:f.TimeIntervalForNextSendInMS-n,this._timer=setTimeout(()=>this._WorkThread(null),t),this._Verbose("_ScheduleTimer, next try: "+t),this._rescheduleFactor=1}}_Verbose(e){this._config.log&&this._config.log.Verbose("[TelemetryManagerImpl]: "+e)}_Info(e){this._config.log&&this._config.log.Info("[TelemetryManagerImpl]: "+e)}_Error(e){this._config.log&&this._config.log.Error("[TelemetryManagerImpl]: "+e)}_Reset(){this._Verbose("Reset()"),this._CleanTimer(),this._lastActiveTime=0,this._rescheduleFactor=1,this._sendingEvents=[],this._eventsCache=new D(this._config.log,this._config.eventsLimitInMem),this._ecsClient&&(this._ecsClient.RemoveListener(this._ecsCallback),this._ecsCallback=null)}_CreateEcsCallback(){return e=>{e==u.CONFIG_UPDATED&&(this._etag=this._ecsClient.GetETag())}}__AddTestHookListener(e){if(this._status<I.Initialized)throw new S(c.DATARV_ERROR_INVALID_STATUS);for(var t=0;t<this._testHookListeners.length;++t)if(this._testHookListeners[t]==e)return;this._testHookListeners.push(e)}__ClearTestHookListener(){this._testHookListeners=[]}__GetListenerArray(){return this._listeners}__GetTotalEventsCount(){return this._eventsCache.GetTotalEventsCount()}__IsScheduled(){return null!=this._timer}__ChageMaxPackageSizeInKB(e){this._MaxPackageSizeInBytes=1024*e}__SetTestServerResponseHook(e){this._testServerResponseHook=e}}b._eventTypeRegex=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,b._tag=0;class D{constructor(e,t){this._logger=e,this._eventsLimitInMem=t,this._events={},this._tokens=[]}AddEvents(e,t){if(t.length){if(t.length>this._eventsLimitInMem)return void this._logDroppedEvents(e,t.length);this._events[e]||(this._events[e]=[],this._tokens.push(e)),this._events[e].push.apply(this._events[e],t)}}IsEmpty(){return 0==this._tokens.length}DequeuEvents(){if(0==this._tokens.length)return null;var e=this._tokens.shift(),t=this._events[e];return delete this._events[e],{tenantToken:e,events:t}}GetTotalEventsCount(){var e=0;for(var t in this._events)e+=this._events[t].length;return e}setEventsLimitInMem(e){this._eventsLimitInMem=e}_logDroppedEvents(e,t){if(!this._logger)return;let n=0;this._events[e]&&(n=this._events[e].length),this._logger.Verbose(`[TelemetryEventCache]: Size of dropped events: ${t},
      events size currently in queue for tenant ${e}: ${n}`)}}}}]);